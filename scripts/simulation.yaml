output_dir: output
data_type: trees
n_samples: 5000
n_jobs: -1
seed: 42

context:
  t1:
    type: uniform
    low: 4
    high: 8

  la1:
    type: uniform
    low: 0.01
    high: 1.0

  mu_over_la1:
    type: uniform
    low: 0.0
    high: 0.9

  psi:
    type: uniform
    low: 0.1
    high: 1.0

  la2:
    type: uniform
    low: 0.01
    high: 1.0

  n_tips:
    type: integers
    low: 100
    high: 1000

parameterization: canonical
states: [A]

birth_rates:
  value: [la1, la2]
  change_times: [t1]

death_rates: mu_over_la1 * la1
sampling_rates: psi

remove_after_sampling: False

n_tips: n_tips

acceptance_criterion: |
  (
    la2 > la1 * 2.01
    and
    tree.age > t1 + 2
    and
    sum(1 for node, time in tree.times.items() if node.is_leaf() and time < t1)
      >= max(15, 0.07 * n_tips)
    and
    sum(1 for node, time in tree.times.items() if node.is_leaf() and time > t1)
      >= max(30, 0.1 * n_tips)
  )

logs:
  num_leaves_before_t1: sum(1 for node, time in tree.times.items() if node.is_leaf() and time < t1)
  num_leaves_after_t1:  sum(1 for node, time in tree.times.items() if node.is_leaf() and time > t1)
  tree_height: tree.age

timeout: 5